name: Test
on:
    push:
        branches:
            - master
            - develop
    pull_request:
        types:
            - ready_for_review
            - synchronize
            - opened
jobs:
    app:
        runs-on: ubuntu-latest
        strategy:
            matrix:
                node-version:
                    - 12.x
        steps:
            - uses: actions/checkout@v2
              with:
                  ref: ${{ github.head_ref }}
            - name: Get yarn cache directory path
              id: yarn-cache-dir-path
              run: echo "::set-output name=dir::$(yarn cache dir)"
            - name: Cache node modules
              uses: actions/cache@v2
              id: yarn-cache
              with:
                  path: ${{ steps.yarn-cache-dir-path.outputs.dir }}
                  key: ${{ runner.os }}-yarn-${{ hashFiles('**/yarn.lock') }}
                  restore-keys: ${{ runner.os }}-yarn-
            - name: Use Node.js ${{ matrix.node-version }}
              uses: actions/setup-node@v1
              with:
                  node-version: ${{ matrix.node-version }}
            - name: Update System
              run: sudo apt-get update
            - name: Install (Ledger Requirements)
              run: sudo apt-get install libudev-dev libusb-1.0-0-dev
            - name: Install (Yarn)
              run: yarn install --frozen-lockfile
            - name: Rebuild
              run: npm rebuild
            - name: Test
              run: yarn test:coverage src/app --forceExit --maxWorkers=4
                  --collectCoverageFrom=src/app/**/*.{js,jsx,ts,tsx}
    domains-contact:
        runs-on: ubuntu-latest
        strategy:
            matrix:
                node-version:
                    - 12.x
        steps:
            - uses: actions/checkout@v2
              with:
                  ref: ${{ github.head_ref }}
            - name: Get yarn cache directory path
              id: yarn-cache-dir-path
              run: echo "::set-output name=dir::$(yarn cache dir)"
            - name: Cache node modules
              uses: actions/cache@v2
              id: yarn-cache
              with:
                  path: ${{ steps.yarn-cache-dir-path.outputs.dir }}
                  key: ${{ runner.os }}-yarn-${{ hashFiles('**/yarn.lock') }}
                  restore-keys: ${{ runner.os }}-yarn-
            - name: Use Node.js ${{ matrix.node-version }}
              uses: actions/setup-node@v1
              with:
                  node-version: ${{ matrix.node-version }}
            - name: Update System
              run: sudo apt-get update
            - name: Install (Ledger Requirements)
              run: sudo apt-get install libudev-dev libusb-1.0-0-dev
            - name: Install (Yarn)
              run: yarn install --frozen-lockfile
            - name: Rebuild
              run: npm rebuild
            - name: Test
              run: yarn test:coverage src/domains/contact --forceExit --maxWorkers=4
                  --collectCoverageFrom=src/domains/contact/**/*.{js,jsx,ts,tsx}
    domains-dashboard:
        runs-on: ubuntu-latest
        strategy:
            matrix:
                node-version:
                    - 12.x
        steps:
            - uses: actions/checkout@v2
              with:
                  ref: ${{ github.head_ref }}
            - name: Get yarn cache directory path
              id: yarn-cache-dir-path
              run: echo "::set-output name=dir::$(yarn cache dir)"
            - name: Cache node modules
              uses: actions/cache@v2
              id: yarn-cache
              with:
                  path: ${{ steps.yarn-cache-dir-path.outputs.dir }}
                  key: ${{ runner.os }}-yarn-${{ hashFiles('**/yarn.lock') }}
                  restore-keys: ${{ runner.os }}-yarn-
            - name: Use Node.js ${{ matrix.node-version }}
              uses: actions/setup-node@v1
              with:
                  node-version: ${{ matrix.node-version }}
            - name: Update System
              run: sudo apt-get update
            - name: Install (Ledger Requirements)
              run: sudo apt-get install libudev-dev libusb-1.0-0-dev
            - name: Install (Yarn)
              run: yarn install --frozen-lockfile
            - name: Rebuild
              run: npm rebuild
            - name: Test
              run: yarn test:coverage src/domains/dashboard --forceExit --maxWorkers=4
                  --collectCoverageFrom=src/domains/dashboard/**/*.{js,jsx,ts,tsx}
    domains-error:
        runs-on: ubuntu-latest
        strategy:
            matrix:
                node-version:
                    - 12.x
        steps:
            - uses: actions/checkout@v2
              with:
                  ref: ${{ github.head_ref }}
            - name: Get yarn cache directory path
              id: yarn-cache-dir-path
              run: echo "::set-output name=dir::$(yarn cache dir)"
            - name: Cache node modules
              uses: actions/cache@v2
              id: yarn-cache
              with:
                  path: ${{ steps.yarn-cache-dir-path.outputs.dir }}
                  key: ${{ runner.os }}-yarn-${{ hashFiles('**/yarn.lock') }}
                  restore-keys: ${{ runner.os }}-yarn-
            - name: Use Node.js ${{ matrix.node-version }}
              uses: actions/setup-node@v1
              with:
                  node-version: ${{ matrix.node-version }}
            - name: Update System
              run: sudo apt-get update
            - name: Install (Ledger Requirements)
              run: sudo apt-get install libudev-dev libusb-1.0-0-dev
            - name: Install (Yarn)
              run: yarn install --frozen-lockfile
            - name: Rebuild
              run: npm rebuild
            - name: Test
              run: yarn test:coverage src/domains/error --forceExit --maxWorkers=4
                  --collectCoverageFrom=src/domains/error/**/*.{js,jsx,ts,tsx}
    domains-exchange:
        runs-on: ubuntu-latest
        strategy:
            matrix:
                node-version:
                    - 12.x
        steps:
            - uses: actions/checkout@v2
              with:
                  ref: ${{ github.head_ref }}
            - name: Get yarn cache directory path
              id: yarn-cache-dir-path
              run: echo "::set-output name=dir::$(yarn cache dir)"
            - name: Cache node modules
              uses: actions/cache@v2
              id: yarn-cache
              with:
                  path: ${{ steps.yarn-cache-dir-path.outputs.dir }}
                  key: ${{ runner.os }}-yarn-${{ hashFiles('**/yarn.lock') }}
                  restore-keys: ${{ runner.os }}-yarn-
            - name: Use Node.js ${{ matrix.node-version }}
              uses: actions/setup-node@v1
              with:
                  node-version: ${{ matrix.node-version }}
            - name: Update System
              run: sudo apt-get update
            - name: Install (Ledger Requirements)
              run: sudo apt-get install libudev-dev libusb-1.0-0-dev
            - name: Install (Yarn)
              run: yarn install --frozen-lockfile
            - name: Rebuild
              run: npm rebuild
            - name: Test
              run: yarn test:coverage src/domains/exchange --forceExit --maxWorkers=4
                  --collectCoverageFrom=src/domains/exchange/**/*.{js,jsx,ts,tsx}
    domains-network:
        runs-on: ubuntu-latest
        strategy:
            matrix:
                node-version:
                    - 12.x
        steps:
            - uses: actions/checkout@v2
              with:
                  ref: ${{ github.head_ref }}
            - name: Get yarn cache directory path
              id: yarn-cache-dir-path
              run: echo "::set-output name=dir::$(yarn cache dir)"
            - name: Cache node modules
              uses: actions/cache@v2
              id: yarn-cache
              with:
                  path: ${{ steps.yarn-cache-dir-path.outputs.dir }}
                  key: ${{ runner.os }}-yarn-${{ hashFiles('**/yarn.lock') }}
                  restore-keys: ${{ runner.os }}-yarn-
            - name: Use Node.js ${{ matrix.node-version }}
              uses: actions/setup-node@v1
              with:
                  node-version: ${{ matrix.node-version }}
            - name: Update System
              run: sudo apt-get update
            - name: Install (Ledger Requirements)
              run: sudo apt-get install libudev-dev libusb-1.0-0-dev
            - name: Install (Yarn)
              run: yarn install --frozen-lockfile
            - name: Rebuild
              run: npm rebuild
            - name: Test
              run: yarn test:coverage src/domains/network --forceExit --maxWorkers=4
                  --collectCoverageFrom=src/domains/network/**/*.{js,jsx,ts,tsx}
    domains-news:
        runs-on: ubuntu-latest
        strategy:
            matrix:
                node-version:
                    - 12.x
        steps:
            - uses: actions/checkout@v2
              with:
                  ref: ${{ github.head_ref }}
            - name: Get yarn cache directory path
              id: yarn-cache-dir-path
              run: echo "::set-output name=dir::$(yarn cache dir)"
            - name: Cache node modules
              uses: actions/cache@v2
              id: yarn-cache
              with:
                  path: ${{ steps.yarn-cache-dir-path.outputs.dir }}
                  key: ${{ runner.os }}-yarn-${{ hashFiles('**/yarn.lock') }}
                  restore-keys: ${{ runner.os }}-yarn-
            - name: Use Node.js ${{ matrix.node-version }}
              uses: actions/setup-node@v1
              with:
                  node-version: ${{ matrix.node-version }}
            - name: Update System
              run: sudo apt-get update
            - name: Install (Ledger Requirements)
              run: sudo apt-get install libudev-dev libusb-1.0-0-dev
            - name: Install (Yarn)
              run: yarn install --frozen-lockfile
            - name: Rebuild
              run: npm rebuild
            - name: Test
              run: yarn test:coverage src/domains/news --forceExit --maxWorkers=4
                  --collectCoverageFrom=src/domains/news/**/*.{js,jsx,ts,tsx}
    domains-plugin:
        runs-on: ubuntu-latest
        strategy:
            matrix:
                node-version:
                    - 12.x
        steps:
            - uses: actions/checkout@v2
              with:
                  ref: ${{ github.head_ref }}
            - name: Get yarn cache directory path
              id: yarn-cache-dir-path
              run: echo "::set-output name=dir::$(yarn cache dir)"
            - name: Cache node modules
              uses: actions/cache@v2
              id: yarn-cache
              with:
                  path: ${{ steps.yarn-cache-dir-path.outputs.dir }}
                  key: ${{ runner.os }}-yarn-${{ hashFiles('**/yarn.lock') }}
                  restore-keys: ${{ runner.os }}-yarn-
            - name: Use Node.js ${{ matrix.node-version }}
              uses: actions/setup-node@v1
              with:
                  node-version: ${{ matrix.node-version }}
            - name: Update System
              run: sudo apt-get update
            - name: Install (Ledger Requirements)
              run: sudo apt-get install libudev-dev libusb-1.0-0-dev
            - name: Install (Yarn)
              run: yarn install --frozen-lockfile
            - name: Rebuild
              run: npm rebuild
            - name: Test
              run: yarn test:coverage src/domains/plugin --forceExit --maxWorkers=4
                  --collectCoverageFrom=src/domains/plugin/**/*.{js,jsx,ts,tsx}
    domains-profile:
        runs-on: ubuntu-latest
        strategy:
            matrix:
                node-version:
                    - 12.x
        steps:
            - uses: actions/checkout@v2
              with:
                  ref: ${{ github.head_ref }}
            - name: Get yarn cache directory path
              id: yarn-cache-dir-path
              run: echo "::set-output name=dir::$(yarn cache dir)"
            - name: Cache node modules
              uses: actions/cache@v2
              id: yarn-cache
              with:
                  path: ${{ steps.yarn-cache-dir-path.outputs.dir }}
                  key: ${{ runner.os }}-yarn-${{ hashFiles('**/yarn.lock') }}
                  restore-keys: ${{ runner.os }}-yarn-
            - name: Use Node.js ${{ matrix.node-version }}
              uses: actions/setup-node@v1
              with:
                  node-version: ${{ matrix.node-version }}
            - name: Update System
              run: sudo apt-get update
            - name: Install (Ledger Requirements)
              run: sudo apt-get install libudev-dev libusb-1.0-0-dev
            - name: Install (Yarn)
              run: yarn install --frozen-lockfile
            - name: Rebuild
              run: npm rebuild
            - name: Test
              run: yarn test:coverage src/domains/profile --forceExit --maxWorkers=4
                  --collectCoverageFrom=src/domains/profile/**/*.{js,jsx,ts,tsx}
    domains-setting:
        runs-on: ubuntu-latest
        strategy:
            matrix:
                node-version:
                    - 12.x
        steps:
            - uses: actions/checkout@v2
              with:
                  ref: ${{ github.head_ref }}
            - name: Get yarn cache directory path
              id: yarn-cache-dir-path
              run: echo "::set-output name=dir::$(yarn cache dir)"
            - name: Cache node modules
              uses: actions/cache@v2
              id: yarn-cache
              with:
                  path: ${{ steps.yarn-cache-dir-path.outputs.dir }}
                  key: ${{ runner.os }}-yarn-${{ hashFiles('**/yarn.lock') }}
                  restore-keys: ${{ runner.os }}-yarn-
            - name: Use Node.js ${{ matrix.node-version }}
              uses: actions/setup-node@v1
              with:
                  node-version: ${{ matrix.node-version }}
            - name: Update System
              run: sudo apt-get update
            - name: Install (Ledger Requirements)
              run: sudo apt-get install libudev-dev libusb-1.0-0-dev
            - name: Install (Yarn)
              run: yarn install --frozen-lockfile
            - name: Rebuild
              run: npm rebuild
            - name: Test
              run: yarn test:coverage src/domains/setting --forceExit --maxWorkers=4
                  --collectCoverageFrom=src/domains/setting/**/*.{js,jsx,ts,tsx}
    domains-splash:
        runs-on: ubuntu-latest
        strategy:
            matrix:
                node-version:
                    - 12.x
        steps:
            - uses: actions/checkout@v2
              with:
                  ref: ${{ github.head_ref }}
            - name: Get yarn cache directory path
              id: yarn-cache-dir-path
              run: echo "::set-output name=dir::$(yarn cache dir)"
            - name: Cache node modules
              uses: actions/cache@v2
              id: yarn-cache
              with:
                  path: ${{ steps.yarn-cache-dir-path.outputs.dir }}
                  key: ${{ runner.os }}-yarn-${{ hashFiles('**/yarn.lock') }}
                  restore-keys: ${{ runner.os }}-yarn-
            - name: Use Node.js ${{ matrix.node-version }}
              uses: actions/setup-node@v1
              with:
                  node-version: ${{ matrix.node-version }}
            - name: Update System
              run: sudo apt-get update
            - name: Install (Ledger Requirements)
              run: sudo apt-get install libudev-dev libusb-1.0-0-dev
            - name: Install (Yarn)
              run: yarn install --frozen-lockfile
            - name: Rebuild
              run: npm rebuild
            - name: Test
              run: yarn test:coverage src/domains/splash --forceExit --maxWorkers=4
                  --collectCoverageFrom=src/domains/splash/**/*.{js,jsx,ts,tsx}
    domains-transaction:
        runs-on: ubuntu-latest
        strategy:
            matrix:
                node-version:
                    - 12.x
        steps:
            - uses: actions/checkout@v2
              with:
                  ref: ${{ github.head_ref }}
            - name: Get yarn cache directory path
              id: yarn-cache-dir-path
              run: echo "::set-output name=dir::$(yarn cache dir)"
            - name: Cache node modules
              uses: actions/cache@v2
              id: yarn-cache
              with:
                  path: ${{ steps.yarn-cache-dir-path.outputs.dir }}
                  key: ${{ runner.os }}-yarn-${{ hashFiles('**/yarn.lock') }}
                  restore-keys: ${{ runner.os }}-yarn-
            - name: Use Node.js ${{ matrix.node-version }}
              uses: actions/setup-node@v1
              with:
                  node-version: ${{ matrix.node-version }}
            - name: Update System
              run: sudo apt-get update
            - name: Install (Ledger Requirements)
              run: sudo apt-get install libudev-dev libusb-1.0-0-dev
            - name: Install (Yarn)
              run: yarn install --frozen-lockfile
            - name: Rebuild
              run: npm rebuild
            - name: Test
              run: yarn test:coverage src/domains/transaction --forceExit --maxWorkers=4
                  --collectCoverageFrom=src/domains/transaction/**/*.{js,jsx,ts,tsx}
    domains-vote:
        runs-on: ubuntu-latest
        strategy:
            matrix:
                node-version:
                    - 12.x
        steps:
            - uses: actions/checkout@v2
              with:
                  ref: ${{ github.head_ref }}
            - name: Get yarn cache directory path
              id: yarn-cache-dir-path
              run: echo "::set-output name=dir::$(yarn cache dir)"
            - name: Cache node modules
              uses: actions/cache@v2
              id: yarn-cache
              with:
                  path: ${{ steps.yarn-cache-dir-path.outputs.dir }}
                  key: ${{ runner.os }}-yarn-${{ hashFiles('**/yarn.lock') }}
                  restore-keys: ${{ runner.os }}-yarn-
            - name: Use Node.js ${{ matrix.node-version }}
              uses: actions/setup-node@v1
              with:
                  node-version: ${{ matrix.node-version }}
            - name: Update System
              run: sudo apt-get update
            - name: Install (Ledger Requirements)
              run: sudo apt-get install libudev-dev libusb-1.0-0-dev
            - name: Install (Yarn)
              run: yarn install --frozen-lockfile
            - name: Rebuild
              run: npm rebuild
            - name: Test
              run: yarn test:coverage src/domains/vote --forceExit --maxWorkers=4
                  --collectCoverageFrom=src/domains/vote/**/*.{js,jsx,ts,tsx}
    domains-wallet:
        runs-on: ubuntu-latest
        strategy:
            matrix:
                node-version:
                    - 12.x
        steps:
            - uses: actions/checkout@v2
              with:
                  ref: ${{ github.head_ref }}
            - name: Get yarn cache directory path
              id: yarn-cache-dir-path
              run: echo "::set-output name=dir::$(yarn cache dir)"
            - name: Cache node modules
              uses: actions/cache@v2
              id: yarn-cache
              with:
                  path: ${{ steps.yarn-cache-dir-path.outputs.dir }}
                  key: ${{ runner.os }}-yarn-${{ hashFiles('**/yarn.lock') }}
                  restore-keys: ${{ runner.os }}-yarn-
            - name: Use Node.js ${{ matrix.node-version }}
              uses: actions/setup-node@v1
              with:
                  node-version: ${{ matrix.node-version }}
            - name: Update System
              run: sudo apt-get update
            - name: Install (Ledger Requirements)
              run: sudo apt-get install libudev-dev libusb-1.0-0-dev
            - name: Install (Yarn)
              run: yarn install --frozen-lockfile
            - name: Rebuild
              run: npm rebuild
            - name: Test
              run: yarn test:coverage src/domains/wallet --forceExit --maxWorkers=4
                  --collectCoverageFrom=src/domains/wallet/**/*.{js,jsx,ts,tsx}
    migrations:
        runs-on: ubuntu-latest
        strategy:
            matrix:
                node-version:
                    - 12.x
        steps:
            - uses: actions/checkout@v2
              with:
                  ref: ${{ github.head_ref }}
            - name: Get yarn cache directory path
              id: yarn-cache-dir-path
              run: echo "::set-output name=dir::$(yarn cache dir)"
            - name: Cache node modules
              uses: actions/cache@v2
              id: yarn-cache
              with:
                  path: ${{ steps.yarn-cache-dir-path.outputs.dir }}
                  key: ${{ runner.os }}-yarn-${{ hashFiles('**/yarn.lock') }}
                  restore-keys: ${{ runner.os }}-yarn-
            - name: Use Node.js ${{ matrix.node-version }}
              uses: actions/setup-node@v1
              with:
                  node-version: ${{ matrix.node-version }}
            - name: Update System
              run: sudo apt-get update
            - name: Install (Ledger Requirements)
              run: sudo apt-get install libudev-dev libusb-1.0-0-dev
            - name: Install (Yarn)
              run: yarn install --frozen-lockfile
            - name: Rebuild
              run: npm rebuild
            - name: Test
              run: yarn test:coverage src/migrations --forceExit --maxWorkers=4
                  --collectCoverageFrom=src/migrations/**/*.{js,jsx,ts,tsx}
    plugins:
        runs-on: ubuntu-latest
        strategy:
            matrix:
                node-version:
                    - 12.x
        steps:
            - uses: actions/checkout@v2
              with:
                  ref: ${{ github.head_ref }}
            - name: Get yarn cache directory path
              id: yarn-cache-dir-path
              run: echo "::set-output name=dir::$(yarn cache dir)"
            - name: Cache node modules
              uses: actions/cache@v2
              id: yarn-cache
              with:
                  path: ${{ steps.yarn-cache-dir-path.outputs.dir }}
                  key: ${{ runner.os }}-yarn-${{ hashFiles('**/yarn.lock') }}
                  restore-keys: ${{ runner.os }}-yarn-
            - name: Use Node.js ${{ matrix.node-version }}
              uses: actions/setup-node@v1
              with:
                  node-version: ${{ matrix.node-version }}
            - name: Update System
              run: sudo apt-get update
            - name: Install (Ledger Requirements)
              run: sudo apt-get install libudev-dev libusb-1.0-0-dev
            - name: Install (Yarn)
              run: yarn install --frozen-lockfile
            - name: Rebuild
              run: npm rebuild
            - name: Test
              run: yarn test:coverage src/plugins --forceExit --maxWorkers=4
                  --collectCoverageFrom=src/plugins/**/*.{js,jsx,ts,tsx}
    router:
        runs-on: ubuntu-latest
        strategy:
            matrix:
                node-version:
                    - 12.x
        steps:
            - uses: actions/checkout@v2
              with:
                  ref: ${{ github.head_ref }}
            - name: Get yarn cache directory path
              id: yarn-cache-dir-path
              run: echo "::set-output name=dir::$(yarn cache dir)"
            - name: Cache node modules
              uses: actions/cache@v2
              id: yarn-cache
              with:
                  path: ${{ steps.yarn-cache-dir-path.outputs.dir }}
                  key: ${{ runner.os }}-yarn-${{ hashFiles('**/yarn.lock') }}
                  restore-keys: ${{ runner.os }}-yarn-
            - name: Use Node.js ${{ matrix.node-version }}
              uses: actions/setup-node@v1
              with:
                  node-version: ${{ matrix.node-version }}
            - name: Update System
              run: sudo apt-get update
            - name: Install (Ledger Requirements)
              run: sudo apt-get install libudev-dev libusb-1.0-0-dev
            - name: Install (Yarn)
              run: yarn install --frozen-lockfile
            - name: Rebuild
              run: npm rebuild
            - name: Test
              run: yarn test:coverage src/router --forceExit --maxWorkers=4
                  --collectCoverageFrom=src/router/**/*.{js,jsx,ts,tsx}
    utils:
        runs-on: ubuntu-latest
        strategy:
            matrix:
                node-version:
                    - 12.x
        steps:
            - uses: actions/checkout@v2
              with:
                  ref: ${{ github.head_ref }}
            - name: Get yarn cache directory path
              id: yarn-cache-dir-path
              run: echo "::set-output name=dir::$(yarn cache dir)"
            - name: Cache node modules
              uses: actions/cache@v2
              id: yarn-cache
              with:
                  path: ${{ steps.yarn-cache-dir-path.outputs.dir }}
                  key: ${{ runner.os }}-yarn-${{ hashFiles('**/yarn.lock') }}
                  restore-keys: ${{ runner.os }}-yarn-
            - name: Use Node.js ${{ matrix.node-version }}
              uses: actions/setup-node@v1
              with:
                  node-version: ${{ matrix.node-version }}
            - name: Update System
              run: sudo apt-get update
            - name: Install (Ledger Requirements)
              run: sudo apt-get install libudev-dev libusb-1.0-0-dev
            - name: Install (Yarn)
              run: yarn install --frozen-lockfile
            - name: Rebuild
              run: npm rebuild
            - name: Test
              run: yarn test:coverage src/utils --forceExit --maxWorkers=4
                  --collectCoverageFrom=src/utils/**/*.{js,jsx,ts,tsx}
